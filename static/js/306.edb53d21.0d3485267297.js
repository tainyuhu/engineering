"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[306],{9540:function(e,a,t){t.r(a),t.d(a,{default:function(){return te}});var r=t(6252),l=t(3577),n=t(9095),c=t(9773),o=t(1669),d=t(7737),s=t(2793),u=t(2762);const g=e=>((0,r.dD)("data-v-b8ec0184"),e=e(),(0,r.Cn)(),e),p={class:"mb-3",style:{"padding-left":"20px",display:"flex","align-items":"center"}},i=g((()=>(0,r._)("span",{class:"font-weight-bold ml-2"},"瀏覽管理總表工程進度：",-1))),_={class:"function-row"},w={class:"status-and-page-size-selector"},m=g((()=>(0,r._)("span",null,"狀態：",-1))),h={key:0,class:"py-2 d-flex justify-center"},y={key:0,class:"div-container"},D={key:1,class:"div-container"},k=g((()=>(0,r._)("th",{rowspan:"2"},"工程 / 週間",-1))),b={class:"font-weight-bold"},j={class:"expected"},x={key:2,class:"div-container"},f=g((()=>(0,r._)("th",{rowspan:"2"},"工程 / 週間",-1))),q={class:"font-weight-bold"},P={class:"expected"};function K(e,a,t,g,K,z){const T=(0,r.up)("WeekProjectTable");return(0,r.wg)(),(0,r.j4)(o.K,null,{default:(0,r.w5)((()=>[(0,r._)("div",p,[(0,r.Wm)(d.t,{color:"blue"},{default:(0,r.w5)((()=>[(0,r.Uk)("mdi-chevron-right-box")])),_:1}),i]),(0,r._)("div",_,[(0,r._)("div",w,[m,(0,r.Wm)(n.T,{class:(0,l.C_)("table"===K.displayMode?"report-btn":"table-btn"),onClick:z.toggleDisplayMode},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(z.displayModeText),1)])),_:1},8,["class","onClick"])]),K.showDetails?((0,r.wg)(),(0,r.iD)("div",h,[(0,r.Wm)(c.fF,{mandatory:"",modelValue:K.timeMode,"onUpdate:modelValue":a[0]||(a[0]=e=>K.timeMode=e),class:"time-toggle",variant:"outlined"},{default:(0,r.w5)((()=>[(0,r.Wm)(n.T,{class:"time-btn",value:"quarter"},{default:(0,r.w5)((()=>[(0,r.Uk)("季")])),_:1}),(0,r.Wm)(n.T,{class:"time-btn",value:"week"},{default:(0,r.w5)((()=>[(0,r.Uk)("週")])),_:1})])),_:1},8,["modelValue"])])):(0,r.kq)("",!0),(0,r._)("div",null,[(0,r.Wm)(n.T,{class:(0,l.C_)("engineering"===K.projectType?"bank-btn":"engineering-btn"),onClick:z.toggleProjectType},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(z.projectTypeText),1)])),_:1},8,["class","onClick"]),(0,r.Wm)(n.T,{class:"overview-btn",rounded:"0",onClick:a[1]||(a[1]=e=>K.showDetails=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)("即時")])),_:1}),(0,r.Wm)(n.T,{class:"details-btn",rounded:"0",onClick:a[2]||(a[2]=e=>K.showDetails=!0)},{default:(0,r.w5)((()=>[(0,r.Uk)("詳情")])),_:1})])]),"week"===K.timeMode&&K.showDetails?((0,r.wg)(),(0,r.iD)("div",y,[(0,r.Wm)(T,{allDateRanges:z.paginatedDateRanges,weekTableData:z.paginatedData},null,8,["allDateRanges","weekTableData"]),(0,r.Wm)(s.k,{modelValue:K.currentPage,"onUpdate:modelValue":a[3]||(a[3]=e=>K.currentPage=e),length:z.totalPages},null,8,["modelValue","length"])])):(0,r.kq)("",!0),"quarter"===K.timeMode&&K.showDetails?((0,r.wg)(),(0,r.iD)("div",D,[(0,r.Wm)(u.Y,null,{default:(0,r.w5)((()=>[(0,r._)("thead",null,[(0,r._)("tr",null,[k,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(z.quarterSummary,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"}," 【"+(0,l.zw)(e.year)+" Q"+(0,l.zw)(e.quarter)+"】 第"+(0,l.zw)(e.week)+"周 ",3)))),128))]),(0,r._)("tr",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(z.paginatedDateRanges,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"},[(0,r.Uk)((0,l.zw)(e)+" ",1),0===a?((0,r.wg)(),(0,r.j4)(d.t,{key:0,color:"yellow"},{default:(0,r.w5)((()=>[(0,r.Uk)("mdi-new-box")])),_:1})):(0,r.kq)("",!0)],2)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(z.paginatedData,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.project_name},[(0,r._)("td",b,(0,l.zw)(e.project_name),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.date_ranges,(e=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("td",{style:(0,l.j5)(e.records[0].expected>e.records[0].actual?{"font-weight":"bold",color:"red"}:{})},(0,l.zw)(z.formatPercentage(e.records[0].actual)),5),(0,r._)("td",j,(0,l.zw)(z.formatPercentage(e.records[0].expected)),1)],64)))),256))])))),128))])])),_:1}),(0,r.Wm)(s.k,{modelValue:K.currentPage,"onUpdate:modelValue":a[4]||(a[4]=e=>K.currentPage=e),length:z.totalPages},null,8,["modelValue","length"])])):(0,r.kq)("",!0),K.showDetails||"table"!==K.displayMode?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",x,[(0,r.Wm)(u.Y,null,{default:(0,r.w5)((()=>[(0,r._)("thead",null,[(0,r._)("tr",null,[f,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(z.quarterSummary,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"}," 【"+(0,l.zw)(e.year)+" Q"+(0,l.zw)(e.quarter)+"】 第"+(0,l.zw)(e.week)+"周 ",3)))),128))]),(0,r._)("tr",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(z.paginatedDateRanges,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"},[(0,r.Uk)((0,l.zw)(e)+" ",1),0===a?((0,r.wg)(),(0,r.j4)(d.t,{key:0,color:"yellow"},{default:(0,r.w5)((()=>[(0,r.Uk)("mdi-new-box")])),_:1})):(0,r.kq)("",!0)],2)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(z.paginatedData,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.project_name},[(0,r._)("td",q,(0,l.zw)(e.project_name),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.date_ranges,(e=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("td",{style:(0,l.j5)(e.records[0].expected>e.records[0].actual?{"font-weight":"bold",color:"red"}:{})},(0,l.zw)(z.formatPercentage(e.records[0].actual)),5),(0,r._)("td",P,(0,l.zw)(z.formatPercentage(e.records[0].expected)),1)],64)))),256))])))),128))])])),_:1}),(0,r.Wm)(s.k,{modelValue:K.currentPage,"onUpdate:modelValue":a[5]||(a[5]=e=>K.currentPage=e),length:z.totalPages},null,8,["modelValue","length"])]))])),_:1})}t(560);var z=t(3388);const T=e=>((0,r.dD)("data-v-11c29bb4"),e=e(),(0,r.Cn)(),e),v=T((()=>(0,r._)("th",null,"項目 / 週間",-1))),V={class:"font-weight-bold"},Y={class:"expected"};function C(e,a,t,n,c,o){return(0,r.wg)(),(0,r.j4)(u.Y,null,{default:(0,r.w5)((()=>[(0,r._)("thead",null,[(0,r._)("tr",null,[v,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.allDateRanges,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"},[(0,r.Uk)((0,l.zw)(e)+" ",1),0===a?((0,r.wg)(),(0,r.j4)(d.t,{key:0,color:"yellow"},{default:(0,r.w5)((()=>[(0,r.Uk)("mdi-new-box")])),_:1})):(0,r.kq)("",!0)],2)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.weekTableData,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.project_name},[(0,r._)("td",V,(0,l.zw)(e.project_name),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.date_ranges,(e=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("td",{style:(0,l.j5)(e.records[0].expected>e.records[0].actual?{"font-weight":"bold",color:"red"}:{})},(0,l.zw)(o.formatPercentage(e.records[0].actual)),5),(0,r._)("td",Y,(0,l.zw)(o.formatPercentage(e.records[0].expected)),1)],64)))),256))])))),128))])])),_:1})}var H={props:{allDateRanges:Array,weekTableData:Array},methods:{formatPercentage(e){return`${(100*Number(e)).toFixed(2)}%`}}},U=t(3744);const M=(0,U.Z)(H,[["render",C],["__scopeId","data-v-11c29bb4"]]);var W=M;const R=e=>((0,r.dD)("data-v-d43463f2"),e=e(),(0,r.Cn)(),e),A=R((()=>(0,r._)("th",{rowspan:"2"},"項目 / 週間",-1))),S={class:"font-weight-bold"},$={class:"expected"};function Q(e,a,t,n,c,o){return(0,r.wg)(),(0,r.j4)(u.Y,null,{default:(0,r.w5)((()=>[(0,r._)("thead",null,[(0,r._)("tr",null,[A,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.quarterSummary,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"}," 【"+(0,l.zw)(e.year)+" Q"+(0,l.zw)(e.quarter)+"】 第"+(0,l.zw)(e.week)+"周 ",3)))),128))]),(0,r._)("tr",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.allDateRanges,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"},[(0,r.Uk)((0,l.zw)(e)+" ",1),0===a?((0,r.wg)(),(0,r.j4)(d.t,{key:0,color:"yellow"},{default:(0,r.w5)((()=>[(0,r.Uk)("mdi-new-box")])),_:1})):(0,r.kq)("",!0)],2)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.quarterTableData,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.project_name},[(0,r._)("td",S,(0,l.zw)(e.project_name),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.date_ranges,(e=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("td",{style:(0,l.j5)(e.records[0].expected>e.records[0].actual?{"font-weight":"bold",color:"red"}:{})},(0,l.zw)(o.formatPercentage(e.records[0].actual)),5),(0,r._)("td",$,(0,l.zw)(o.formatPercentage(e.records[0].expected)),1)],64)))),256))])))),128))])])),_:1})}var E={props:{allDateRanges:Array,quarterSummary:Array,quarterTableData:Array},created(){console.log("this.quarterTableData",this.quarterTableData)},methods:{formatPercentage(e){return`${(100*Number(e)).toFixed(2)}%`}}};const F=(0,U.Z)(E,[["render",Q],["__scopeId","data-v-d43463f2"]]);var Z=F;const I=e=>((0,r.dD)("data-v-46418e66"),e=e(),(0,r.Cn)(),e),L=I((()=>(0,r._)("th",{rowspan:"2"},"項目 / 週間",-1))),N={class:"font-weight-bold"},B={class:"expected"};function G(e,a,t,n,c,o){return(0,r.wg)(),(0,r.j4)(u.Y,null,{default:(0,r.w5)((()=>[(0,r._)("thead",null,[(0,r._)("tr",null,[L,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.quarterSummary,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"}," 【"+(0,l.zw)(e.year)+" Q"+(0,l.zw)(e.quarter)+"】 第"+(0,l.zw)(e.week)+"周 ",3)))),128))]),(0,r._)("tr",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.allDateRanges,((e,a)=>((0,r.wg)(),(0,r.iD)("th",{key:a,class:(0,l.C_)({"special-bg":0===a,"normal-bg":0!==a}),colspan:"2"},[(0,r.Uk)((0,l.zw)(e)+" ",1),0===a?((0,r.wg)(),(0,r.j4)(d.t,{key:0,color:"yellow"},{default:(0,r.w5)((()=>[(0,r.Uk)("mdi-new-box")])),_:1})):(0,r.kq)("",!0)],2)))),128))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.TableData,(e=>((0,r.wg)(),(0,r.iD)("tr",{key:e.project_name},[(0,r._)("td",N,(0,l.zw)(e.project_name),1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.date_ranges,(e=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("td",{style:(0,l.j5)(e.records[0].expected>e.records[0].actual?{"font-weight":"bold",color:"red"}:{})},(0,l.zw)(o.formatPercentage(e.records[0].actual)),5),(0,r._)("td",B,(0,l.zw)(o.formatPercentage(e.records[0].expected)),1)],64)))),256))])))),128))])])),_:1})}var J={props:{allDateRanges:Array,quarterSummary:Array,TableData:Array},methods:{formatPercentage(e){return`${(100*Number(e)).toFixed(2)}%`}}};const O=(0,U.Z)(J,[["render",G],["__scopeId","data-v-46418e66"]]);var X=O,ee={components:{Chart:z.Z,WeekProjectTable:W,AllQuarterProjectTable:Z,QuarterProjectTable:X},data(){return{timeMode:"week",displayMode:"table",projectType:"engineering",showDetails:!1,weekTableData:[{actual:.3317,date_range:"2023-12-30 - 2024-01-06",expected:.3317,project_name:"161KV"},{actual:0,date_range:"2023-12-30 - 2024-01-06",expected:7e-4,project_name:"案場"},{actual:.1181,date_range:"2023-12-30 - 2024-01-06",expected:.0095,project_name:"電業申辦"},{actual:.3317,date_range:"2024-01-07 - 2024-01-13",expected:.3317,project_name:"161KV"},{actual:0,date_range:"2024-01-07 - 2024-01-13",expected:.0054,project_name:"22.8KV"},{actual:0,date_range:"2024-01-07 - 2024-01-13",expected:7e-4,project_name:"案場"},{actual:.1181,date_range:"2024-01-07 - 2024-01-13",expected:.019,project_name:"電業申辦"},{actual:.3317,date_range:"2024-01-14 - 2024-01-20",expected:.3317,project_name:"161KV"},{actual:0,date_range:"2024-01-14 - 2024-01-20",expected:.0108,project_name:"22.8KV"},{actual:0,date_range:"2024-01-14 - 2024-01-20",expected:.0033,project_name:"案場"},{actual:.1181,date_range:"2024-01-14 - 2024-01-20",expected:.0286,project_name:"電業申辦"},{actual:.3317,date_range:"2024-01-21 - 2024-01-27",expected:.3317,project_name:"161KV"},{actual:.0949,date_range:"2024-01-21 - 2024-01-27",expected:.0162,project_name:"22.8KV"},{actual:0,date_range:"2024-01-21 - 2024-01-27",expected:.004,project_name:"案場"},{actual:.1181,date_range:"2024-01-21 - 2024-01-27",expected:.0381,project_name:"電業申辦"},{actual:.3317,date_range:"2024-01-28 - 2024-02-03",expected:.3317,project_name:"161KV"},{actual:.0949,date_range:"2024-01-28 - 2024-02-03",expected:.0216,project_name:"22.8KV"},{actual:0,date_range:"2024-01-28 - 2024-02-03",expected:.004,project_name:"案場"},{actual:.1181,date_range:"2024-01-28 - 2024-02-03",expected:.0476,project_name:"電業申辦"},{actual:.3317,date_range:"2024-02-04 - 2024-02-10",expected:.3317,project_name:"161KV"},{actual:.0949,date_range:"2024-02-04 - 2024-02-10",expected:.027,project_name:"22.8KV"},{actual:0,date_range:"2024-02-04 - 2024-02-10",expected:.004,project_name:"案場"},{actual:.1181,date_range:"2024-02-04 - 2024-02-10",expected:.0571,project_name:"電業申辦"},{actual:.3317,date_range:"2024-02-11 - 2024-02-17",expected:.3317,project_name:"161KV"},{actual:.0949,date_range:"2024-02-11 - 2024-02-17",expected:.0324,project_name:"22.8KV"},{actual:.0016,date_range:"2024-02-11 - 2024-02-17",expected:.004,project_name:"案場"},{actual:.1181,date_range:"2024-02-11 - 2024-02-17",expected:.0667,project_name:"電業申辦"},{actual:.3317,date_range:"2024-02-18 - 2024-02-24",expected:.3317,project_name:"161KV"},{actual:.0949,date_range:"2024-02-18 - 2024-02-24",expected:.0378,project_name:"22.8KV"},{actual:.0024,date_range:"2024-02-18 - 2024-02-24",expected:.005,project_name:"案場"},{actual:.1181,date_range:"2024-02-18 - 2024-02-24",expected:.0762,project_name:"電業申辦"},{actual:.3317,date_range:"2024-02-25 - 2024-03-02",expected:.3317,project_name:"161KV"},{actual:.0964,date_range:"2024-02-25 - 2024-03-02",expected:.0432,project_name:"22.8KV"},{actual:.0036,date_range:"2024-02-25 - 2024-03-02",expected:.0051,project_name:"案場"},{actual:.3114,date_range:"2024-02-25 - 2024-03-02",expected:.0857,project_name:"電業申辦"}],quarterTableData:[{actual:.3317,date_range:"2024-02-25 - 2024-03-02",expected:.3317,project_name:"161KV",year:2024,quarter:1,week:9},{actual:.0964,date_range:"2024-02-25 - 2024-03-02",expected:.0432,project_name:"22.8KV",year:2024,quarter:1,week:9},{actual:.0036,date_range:"2024-02-25 - 2024-03-02",expected:.0051,project_name:"案場",year:2024,quarter:1,week:9},{actual:.3114,date_range:"2024-02-25 - 2024-03-02",expected:.0857,project_name:"電業申辦",year:2024,quarter:1,week:9}],TableData:[{actual:.3317,date_range:"2024-02-25 - 2024-03-02",expected:.3317,project_name:"161KV",year:2024,quarter:1,week:9},{actual:.0964,date_range:"2024-02-25 - 2024-03-02",expected:.0432,project_name:"22.8KV",year:2024,quarter:1,week:9},{actual:.0036,date_range:"2024-02-25 - 2024-03-02",expected:.0051,project_name:"案場",year:2024,quarter:1,week:9},{actual:.3114,date_range:"2024-02-25 - 2024-03-02",expected:.0857,project_name:"電業申辦",year:2024,quarter:1,week:9}],currentPage:1,perPage:3}},watch:{},async created(){this.selectedPlan=this.$route.query.Plan,this.selectedProject=this.$route.query.Project},computed:{displayModeText(){return"table"===this.displayMode?"表格":"報表"},projectTypeText(){return"engineering"===this.projectType?"工程":"銀行"},allDateRanges(){const e=new Set;return this.organizedLoopsData.forEach((a=>{a.date_ranges.forEach((a=>{e.add(a.date_range)}))})),Array.from(e)},quarterSummary(){let e=this.organizedLoopsData;if(console.log(e),!e.length)return[];const a=new Set;return e.forEach((e=>{e.date_ranges.forEach((e=>{const t=`${e.year}-Q${e.quarter}-${e.week}`;a.add(t)}))})),Array.from(a).map((e=>{const[a,t,r]=e.split("-");return{year:a,quarter:t.replace("Q",""),week:r}}))},totalPages(){const e=this.allDateRanges.length;return Math.ceil(e/this.perPage)},paginatedData(){const e=(this.currentPage-1)*this.perPage,a=e+this.perPage,t=this.organizedLoopsData.map((t=>({...t,date_ranges:t.date_ranges.slice(e,a)})));return console.log(t),t},paginatedDateRanges(){const e=(this.currentPage-1)*this.perPage,a=e+this.perPage;return this.allDateRanges.slice(e,a)},organizedLoopsData(){const e=[],a=new Map;let t=[];return this.showDetails?"quarter"===this.timeMode?t=this.quarterTableData:"week"===this.timeMode&&(t=this.weekTableData):t=this.TableData,t.forEach((e=>{const{project_name:t,date_range:r,actual:l,expected:n,year:c,quarter:o,week:d}=e;a.has(t)||a.set(t,{project_name:t,date_ranges:[]});const s=a.get(t);let u=s.date_ranges.find((e=>e.date_range===r));u||(u={date_range:r,records:[],year:c,quarter:o,week:d},s.date_ranges.push(u)),u.records.push({actual:l,expected:n})})),a.forEach((a=>{a.date_ranges.sort(((e,a)=>{const t=new Date(e.date_range.split(" - ")[0]),r=new Date(a.date_range.split(" - ")[0]);return t-r})),e.push(a)})),e}},methods:{toggleDisplayMode(){this.displayMode="table"===this.displayMode?"report":"table",this.showDetails=!1},toggleProjectType(){this.projectType="engineering"===this.projectType?"bank":"engineering"},formatPercentage(e){return`${(100*Number(e)).toFixed(2)}%`}}};const ae=(0,U.Z)(ee,[["render",K],["__scopeId","data-v-b8ec0184"]]);var te=ae}}]);
//# sourceMappingURL=306.edb53d21.js.f556cf9e215d.map