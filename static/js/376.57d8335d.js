"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[376],{9022:function(e,t,o){var s=o(5121);const a=s.Z.create({baseURL:"/",headers:{"Content-Type":"application/json"}});a.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>(console.error("Request error:",e),Promise.reject(e)))),a.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(window.location.href="/login"),alert(`錯誤提醒: ${e.message},請截圖回報管理人員`),Promise.reject(e)))),t.Z=a},440:function(e,t,o){o.d(t,{ZQ:function(){return l},bl:function(){return i},dc:function(){return a},m0:function(){return n}});var s=o(9022);const a=()=>s.Z.get("/api/v1/fileprogress/"),l=()=>s.Z.get("/api/v1/plans/"),i=()=>s.Z.get("/api/v1/projects/"),n=e=>s.Z.get(`/api/v1/project-loops-by-project/${e}/`)},9351:function(e,t,o){o.d(t,{y:function(){return a}});var s=o(9022);const a=e=>s.Z.get(`/api/v1/get_pv_progress_and_expected/${e}/`,{headers:{Accept:"application/json"}})},4376:function(e,t,o){o.r(t),o.d(t,{default:function(){return L}});var s=o(6252),a=o(3577),l=o(9095),i=o(9773),n=o(1669),c=o(7737);const r=e=>((0,s.dD)("data-v-591b35e6"),e=e(),(0,s.Cn)(),e),d={class:"mb-3",style:{"padding-left":"20px",display:"flex","align-items":"center"}},p=r((()=>(0,s._)("span",{class:"font-weight-bold ml-2"},"瀏覽PV工程進度：",-1))),h={class:"mb-3",style:{"padding-left":"40px",display:"flex","align-items":"center"}},u=r((()=>(0,s._)("span",{class:"font-weight-bold ml-2"},"選擇迴路：",-1))),g=r((()=>(0,s._)("span",{class:"ml-1 note-span"},"※在下方選擇一個迴路後，才會顯示迴路的進度內容",-1))),w={class:"loops-selection"},f={class:"function-row"},k={key:0,class:"status-section"},y=r((()=>(0,s._)("span",null,"狀態：",-1))),b={key:1,class:"time-section py-2 d-flex justify-center"},m={key:2,class:"action-section"};function _(e,t,o,r,_,v){return(0,s.wg)(),(0,s.j4)(n.K,null,{default:(0,s.w5)((()=>[(0,s._)("div",d,[(0,s.Wm)(c.t,{color:"blue"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-chevron-right-box")])),_:1}),p]),(0,s._)("div",h,[(0,s.Wm)(c.t,{color:"orange"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-chevron-right-box")])),_:1}),u,g]),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_.loops,(e=>((0,s.wg)(),(0,s.j4)(l.T,{key:e.loop_id,class:(0,a.C_)(["loop-button",{"loop-button--active":e.loop_id===_.selectedLoopId}]),onClick:t=>v.selectLoop(e.loop_id)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.loop_name),1)])),_:2},1032,["class","onClick"])))),128))]),(0,s._)("div",f,[_.selectedLoopId?((0,s.wg)(),(0,s.iD)("div",k,[y,(0,s.Wm)(l.T,{class:(0,a.C_)("table"===_.displayMode?"report-btn":"table-btn"),onClick:v.toggleDisplayMode},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(v.displayModeText),1)])),_:1},8,["class","onClick"])])):(0,s.kq)("",!0),_.showDetails?((0,s.wg)(),(0,s.iD)("div",b,[(0,s.Wm)(i.fF,{modelValue:e.timeMode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.timeMode=t),class:"time-toggle",variant:"outlined"},{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{class:"time-btn",value:"quarter"},{default:(0,s.w5)((()=>[(0,s.Uk)("季")])),_:1}),(0,s.Wm)(l.T,{class:"time-btn",value:"week"},{default:(0,s.w5)((()=>[(0,s.Uk)("週")])),_:1})])),_:1},8,["modelValue"])])):(0,s.kq)("",!0),_.selectedLoopId&&"table"===_.displayMode?((0,s.wg)(),(0,s.iD)("div",m,[_.showDetails?((0,s.wg)(),(0,s.j4)(l.T,{key:0,class:(0,a.C_)("engineering"===_.projectType?"bank-btn":"engineering-btn"),onClick:v.toggleProjectType},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(v.projectTypeText),1)])),_:1},8,["class","onClick"])):(0,s.kq)("",!0),(0,s.Wm)(l.T,{class:"overview-btn",onClick:t[1]||(t[1]=e=>_.showDetails=!1)},{default:(0,s.w5)((()=>[(0,s.Uk)("總覽")])),_:1}),(0,s.Wm)(l.T,{class:"details-btn",onClick:t[2]||(t[2]=e=>_.showDetails=!0)},{default:(0,s.w5)((()=>[(0,s.Uk)("詳情")])),_:1})])):(0,s.kq)("",!0)])])),_:1})}var v=o(440),j=o(9351),D={data(){return{loops:[],cases:[],selectedProject:[],selectedPlan:null,selectedLoopId:null,displayMode:"table",projectType:"engineering",showDetails:!1,weekTableData:[]}},watch:{selectedLoopId(e){e&&this.showDetails&&"week"===this.timeMode&&this.fetchWeekData()},showDetails(e){e&&this.selectedLoopId&&"week"===this.timeMode&&this.fetchWeekData()},timeMode(e){"week"===e&&this.selectedLoopId&&this.showDetails&&this.fetchWeekData()}},async created(){this.selectedPlan=this.$route.query.Plan,this.selectedProject=this.$route.query.Project,console.log("api response:",this.selectedProject),await this.fetchLoops()},computed:{displayModeText(){return"table"===this.displayMode?"表格":"報表"},projectTypeText(){return"engineering"===this.projectType?"工程":"銀行"}},methods:{async fetchLoops(){try{console.log("api response:",this.selectedProject);const{data:e}=await(0,v.m0)(this.selectedProject);console.log("loopsdata:",e),this.loops=e}catch(e){console.error("Error fetching loops:",e)}},async fetchWeekData(){if(this.selectedLoopId)try{const e=await(0,j.y)(this.selectedLoopId);console.log("weekTableData:",e.data),this.weekTableData=e.data}catch(e){console.error("Error fetching week table data:",e),this.weekTableData=[]}},selectLoop(e){this.selectedLoopId=e,this.fetchWeekData()},toggleDisplayMode(){this.displayMode="table"===this.displayMode?"report":"table",this.showDetails=!1},toggleProjectType(){this.projectType="engineering"===this.projectType?"bank":"engineering"}}},T=o(3744);const C=(0,T.Z)(D,[["render",_],["__scopeId","data-v-591b35e6"]]);var L=C}}]);
//# sourceMappingURL=376.57d8335d.js.map